SQL>
SQL> -- 1a Retrieve by the years (in the period 2000 to 2009) the count
SQL> -- of movies produced in a genre (choose one among Comedy, Drama,
SQL> -- Horror, Sci-Fi) whose rating was greater than the average rating
SQL> -- of movies in that year.
SQL>


STAR
----
GENRES
--------------------------------------------------------------------------------
 ABOVE_AVG
----------
2000
Comedy
       134

2001
Comedy
       136

STAR
----
GENRES
--------------------------------------------------------------------------------
 ABOVE_AVG
----------

2002
Comedy
       123

2003
Comedy

STAR
----
GENRES
--------------------------------------------------------------------------------
 ABOVE_AVG
----------
       153

2004
Comedy
       176

2005

STAR
----
GENRES
--------------------------------------------------------------------------------
 ABOVE_AVG
----------
Comedy
       220

2006
Comedy
       224


STAR
----
GENRES
--------------------------------------------------------------------------------
 ABOVE_AVG
----------
2007
Comedy
       207

2008
Comedy
       257

STAR
----
GENRES
--------------------------------------------------------------------------------
 ABOVE_AVG
----------

2009
Comedy
       267


10 rows selected.

SQL>
SQL> -- 1b Total count of movies produced in each year for the above
SQL> --genre chosen in 1a.
SQL>


YEAR
----
GENRES
--------------------------------------------------------------------------------
MOVIES_PRODUCED
---------------
2000
Comedy
            325

2001
Comedy
            312

YEAR
----
GENRES
--------------------------------------------------------------------------------
MOVIES_PRODUCED
---------------

2002
Comedy
            314

2003
Comedy

YEAR
----
GENRES
--------------------------------------------------------------------------------
MOVIES_PRODUCED
---------------
            398

2004
Comedy
            443

2005

YEAR
----
GENRES
--------------------------------------------------------------------------------
MOVIES_PRODUCED
---------------
Comedy
            539

2006
Comedy
            567


YEAR
----
GENRES
--------------------------------------------------------------------------------
MOVIES_PRODUCED
---------------
2007
Comedy
            562

2008
Comedy
            689

YEAR
----
GENRES
--------------------------------------------------------------------------------
MOVIES_PRODUCED
---------------

2009
Comedy
            751


10 rows selected.

SQL>
SQL> -- 2a. retrieve the average ratings of the movies for each year
SQL> --during 2010 and 2018 (both inclusive) for the genres Drama,
SQL> --Horror, Sci-Fi, and Thriller
SQL>


STAR YEARLY_AVG
---- ----------
2010 6.08697674
2011 6.12146928
2012 6.12236994
2013 6.10227125
2014 6.13537285
2015 6.14614004
2016  6.2318209
2017 6.55640719
2018  6.8920354

9 rows selected.

SQL>
SQL> -- 2b Retrieve the average ratings of the movies by genre for each
SQL> --year during 2010 and 2018 for each genre Drama, Horror, Sci-Fi,
SQL> --and Thriller. Should have 36 rows of output, for 9 years and 4
SQL> --genres.
SQL>


STAR
----
GENRES
--------------------------------------------------------------------------------
YEARLY_AVG
----------
2010
Drama
6.35474326

2010
Horror
4.93798077

STAR
----
GENRES
--------------------------------------------------------------------------------
YEARLY_AVG
----------

2010
Sci-Fi
5.27391304

2010
Thriller

STAR
----
GENRES
--------------------------------------------------------------------------------
YEARLY_AVG
----------
    5.6872

2011
Drama
6.40383653

2011

STAR
----
GENRES
--------------------------------------------------------------------------------
YEARLY_AVG
----------
Horror
4.95151515

2011
Sci-Fi
      5.17


STAR
----
GENRES
--------------------------------------------------------------------------------
YEARLY_AVG
----------
2011
Thriller
5.78739496

2012
Drama
6.47727987

STAR
----
GENRES
--------------------------------------------------------------------------------
YEARLY_AVG
----------

2012
Horror
4.98027211

2012
Sci-Fi

STAR
----
GENRES
--------------------------------------------------------------------------------
YEARLY_AVG
----------
4.99583333

2012
Thriller
5.48928571

2013

STAR
----
GENRES
--------------------------------------------------------------------------------
YEARLY_AVG
----------
Drama
6.46666667

2013
Horror
 4.8939759


STAR
----
GENRES
--------------------------------------------------------------------------------
YEARLY_AVG
----------
2013
Sci-Fi
5.46666667

2013
Thriller
5.61341463

STAR
----
GENRES
--------------------------------------------------------------------------------
YEARLY_AVG
----------

2014
Drama
6.54582185

2014
Horror

STAR
----
GENRES
--------------------------------------------------------------------------------
YEARLY_AVG
----------
4.94344828

2014
Sci-Fi
      5.28

2014

STAR
----
GENRES
--------------------------------------------------------------------------------
YEARLY_AVG
----------
Thriller
    5.6625

2015
Drama
 6.4867052


STAR
----
GENRES
--------------------------------------------------------------------------------
YEARLY_AVG
----------
2015
Horror
4.79851301

2015
Sci-Fi
 5.7137931

STAR
----
GENRES
--------------------------------------------------------------------------------
YEARLY_AVG
----------

2015
Thriller
 5.9154321

2016
Drama

STAR
----
GENRES
--------------------------------------------------------------------------------
YEARLY_AVG
----------
6.65143854

2016
Horror
      4.92

2016

STAR
----
GENRES
--------------------------------------------------------------------------------
YEARLY_AVG
----------
Sci-Fi
5.89722222

2016
Thriller
 5.8142132


STAR
----
GENRES
--------------------------------------------------------------------------------
YEARLY_AVG
----------
2017
Drama
7.01645907

2017
Horror
5.37677419

STAR
----
GENRES
--------------------------------------------------------------------------------
YEARLY_AVG
----------

2017
Sci-Fi
5.75581395

2017
Thriller

STAR
----
GENRES
--------------------------------------------------------------------------------
YEARLY_AVG
----------
5.95025907

2018
Drama
7.18765432

2018

STAR
----
GENRES
--------------------------------------------------------------------------------
YEARLY_AVG
----------
Horror
     5.475

2018
Sci-Fi
      5.58


STAR
----
GENRES
--------------------------------------------------------------------------------
YEARLY_AVG
----------
2018
Thriller
6.86666667


36 rows selected.

SQL>
SQL> spool off
